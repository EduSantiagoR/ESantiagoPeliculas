@model ML.Venta
@{
    ViewData["Title"] = "Carrito";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1 class="text-center">Carrito</h1>
<hr />
<div class="container">
    @if(Model.Carrito != null)
    {
        
        if(Model.Carrito.Count > 0)
        {
            <div>
                <a class="btn btn-danger" href="@Url.Action("ClearCarrito","Dulceria")">Vaciar carrito</a>
            </div>
            <br />
            <table class="table table-dark table-hover text-center">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Descripción</th>
                        <th>Cantidad</th>
                        <th>Precio ($)</th>
                        <th>Agregar</th>
                        <th>Quitar</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach(ML.Dulceria dulce in Model.Carrito)
                    {
                        <tr>
                            <td>@dulce.Nombre</td>
                            <td>@dulce.Descripcion</td>
                            <td class="tdCantidad">@dulce.Cantidad</td>
                            <td class="tdPrecio">@dulce.Precio</td>
                            <td><a class="btn btn-success" href="@Url.Action("AddCarrito","Dulceria",new{idDulce = dulce.IdDulce})"><i class="fa-solid fa-cart-plus"></i></a></td>
                            <td><a class="btn btn-danger" href="@Url.Action("AddCarrito","Dulceria",new{idDulce = dulce.IdDulce,accion="Delete"})"><i class="fa-regular fa-trash-can"></i></a></td>
                        </tr>
                    }
                </tbody>
                <tfoot>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th>Total: <label id="lblTotal"></label></th>
                        <th></th>
                        <th></th>
                    </tr>
                </tfoot>
            </table>
        }
        else
        {
            <div class="alert alert-warning" role="alert">
                <i class="fa-solid fa-bell"></i> Aún no has agregado productos a tu carrito
            </div>
        }
    }
</div>
<script type="text/javascript">
    var preciosList = document.querySelectorAll(".tdPrecio");
    var cantidadList = document.querySelectorAll(".tdCantidad");
    var index = 0;
    var total = 0;
    preciosList.forEach(function(td){
        total += parseInt(td.textContent) * parseInt(cantidadList[index].textContent);
        index += 1;
    });
    document.getElementById("lblTotal").innerHTML = total;
</script>